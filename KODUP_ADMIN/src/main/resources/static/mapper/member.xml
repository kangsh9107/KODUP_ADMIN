<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kodup.admin.member.AdminMemberMapper">

   <select id="totlist" parameterType="com.kodup.admin.member.MemberPageVo" resultType="Integer">
		select count(id) totSize from member
		where id = #{findStr}
		or    email     like '%${findStr}%'
		or    nickname  like '%${findStr}%'
		or    join_date like '%${findStr}%'   
	</select>
	
    <select id="select" parameterType="com.kodup.admin.member.MemberPageVo" resultType="com.kodup.admin.member.AdminMemberVo">
        select id, nickname, email, join_date from member
        WHERE id LIKE '%${findStr}%' OR nickname LIKE '%${findStr}%' or email LIKE '%${findStr}%'
        order by join_date desc
        limit ${startNo}, ${listSize}
       
	</select>
	
	<select id='view' parameterType="com.kodup.admin.member.MemberPageVo" resultType="com.kodup.admin.member.AdminMemberVo">
       SELECT m.profile_img, m.id, m.pwd, m.email, m.nickname, m.gender, m.age, m.account_type, m.ban_status, m.pixel, m.grade, m.join_date, m.email_status, m.mento_status, 
       mi.introduce,
       r.repl_doc, date_format(r.repl_nal,'%Y-%m-%d'),
       b.subject, date_format(b.nal,'%Y-%m-%d')
       FROM member m LEFT JOIN member_introduce mi ON m.id = mi.id
                     LEFT JOIN repl r              ON m.id = r.id
                     LEFT JOIN board b             ON m.id = b.id
       WHERE m.id=#{id}   
       limit 1,5
    </select>
    
    <select id="banselect" parameterType="com.kodup.admin.member.MemberPageVo" resultType="com.kodup.admin.member.AdminMemberVo">
        select id, nickname, email, ban_status from member
        WHERE id LIKE '%${findStr}%' OR nickname LIKE '%${findStr}%' or email LIKE '%${findStr}%'
        order by ban_status desc
        limit ${startNo}, ${listSize}
       
	</select>
	
	<update id="make_ban" parameterType="com.kodup.admin.member.AdminMemberVo">
	   update member set ban_status = 1
	   where id = #{id}
	</update>
	
	<update id="make_activity" parameterType="com.kodup.admin.member.AdminMemberVo">
	   update member set ban_status = 0
	   where id = #{id}
	</update>
</mapper>